[phases.setup]
apt_packages = ["nodejs", "npm", "php8.4", "php8.4-common", "php8.4-cli", "php8.4-curl", "php8.4-mbstring", "php8.4-xml", "php8.4-zip", "php8.4-mysql", "php8.4-bcmath", "nginx", "libmysqlclient"]

[phases.install]
cmds = [
  "mkdir -p /var/log/nginx",
  "mkdir -p /var/cache/nginx",
  "composer install --no-dev --no-interaction --optimize-autoloader",
  "npm ci --only=production"
]

[phases.build]
cmds = ["npm run build"]

[start]
cmd = "php artisan serve --host=0.0.0.0 --port=${PORT}"